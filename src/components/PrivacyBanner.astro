---
import type { Dictionary } from '../i18n';

interface Props {
  dict: Dictionary;
}

const { dict } = Astro.props;
---
<div class="privacy-banner" data-banner>
  <p>{dict.privacyBanner.message}</p>
  <button type="button">{dict.privacyBanner.dismiss}</button>
</div>
<style>
  .privacy-banner {
    display: none;
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    max-width: min(22rem, 90vw);
    background: color-mix(in srgb, white 90%, transparent);
    color: #1f2933;
    padding: 1rem 1.25rem;
    border-radius: 0.75rem;
    box-shadow: 0 1rem 3rem rgba(15, 23, 42, 0.15);
    z-index: 50;
    gap: 0.75rem;
    font-size: 0.875rem;
  }

  .privacy-banner[data-active="true"] {
    display: grid;
  }

  .privacy-banner button {
    justify-self: flex-end;
    background: #1f2933;
    color: white;
    border: none;
    border-radius: 9999px;
    padding: 0.25rem 0.75rem;
    cursor: pointer;
    font-weight: 600;
  }
</style>
<script>
  const banner = document.currentScript?.previousElementSibling;
  if (banner instanceof HTMLElement) {
    const storageKey = 'privacy-banner-dismissed';
    const dismissed = window.localStorage.getItem(storageKey);
    if (!dismissed) {
      banner.dataset.active = 'true';
    }
    const button = banner.querySelector('button');
    button?.addEventListener('click', () => {
      window.localStorage.setItem(storageKey, '1');
      banner.removeAttribute('data-active');
      banner.style.display = 'none';
    });
  }
</script>
